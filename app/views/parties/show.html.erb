<h1><%=@party.title%></h1>
<h2><%=@party.description%></h2>

<% unless @party.photo.nil? %>
<%= image_tag "#{@party.photo}", height: 100, width: 300%>
<% else %>
<%= image_tag("default_image.jpg", size: "160x100", alt: "Default Party Image")%>
<% end %>

  <div class="wrapper">
    <div class="container d-flex flex-column justify-content-center align-items-center">
      <div class="title text-center mb-5">
      </div>
      <div class="chart-wrapper">
        <div class="chart-container" style="position: relative; height:40vh; width:80vw">
        <canvas id="myChart"></canvas>
        </div>
      </div>
    </div>
    <p><%= @danceability %>%</p>
    <p><%= @energy %>%</p>
    <p><%= @valence %>%</p>
    <p><%= @popularity %>%</p>


    <%= link_to "Tracks", party_playlist_tracks_path(@party.id, @party.playlist.id) %>

    <%= render 'shared/navbar' %>
  </div>
  <script>
  let ctx = document.getElementById('myChart').getContext('2d');
  let labels = ["danceability","energy","valence","popularity"];
  let colorHex = ['#32C5FF', '#B620E0', '#F7B500', '#808080'];

  let myChart = new Chart(ctx, {
    type: 'doughnut',
    data: {
      datasets: [{
        data: [<%=@danceability %>,<%= @energy %>,<%= @valence %>,<%= @popularity %>],
        backgroundColor: colorHex
      }],
      labels: labels
    },
    options: {
      responsive: true,
      legend: {
        position: 'bottom'
      },
      plugins: {
        datalabels: {
          color: '#fff',
          anchor: 'end',
          align: 'start',
          offset: -10,
          borderWidth: 2,
          borderColor: '#fff',
          borderRadius: 25,
          backgroundColor: (context) => {
            return context.dataset.backgroundColor;
          },
          font: {
            weight: 'bold',
            size: '10'
          },
          formatter: (value) => {
            return value + ' %';
          }
        }
      }
    }
  })

  </script>

